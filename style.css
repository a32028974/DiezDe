const consignasGenerales = window.CONSIGNAS_GENERALES;
const consignasAdulto = window.CONSIGNAS_ADULTO;

const btnIniciar = document.getElementById("btnIniciar");
const btnRepetir = document.getElementById("btnRepetir");
const btnTerminar = document.getElementById("btnTerminar");
const btnMusica = document.getElementById("btnMusica");
const musica = document.getElementById("musicaFondo");

const vistaLectura = document.getElementById("vistaLectura");
const vistaRespuesta = document.getElementById("vistaRespuesta");
const lista = document.getElementById("listaConsignas");
const timerEl = document.getElementById("timer");
const estado = document.getElementById("estado");

let ronda = [];
let timer = null;
let musicaActiva = false;

// MÃºsica
btnMusica.onclick = ()=>{
  musicaActiva = !musicaActiva;
  if(musicaActiva){
    musica.volume = 0.25;
    musica.play();
    btnMusica.textContent = "ðŸ”Š MÃºsica";
  }else{
    musica.pause();
    btnMusica.textContent = "ðŸŽµ MÃºsica";
  }
};

function seleccionarRonda(){
  return consignasGenerales.sort(()=>0.5-Math.random()).slice(0,10);
}

btnIniciar.onclick = async ()=>{
  musica.pause();
  ronda = seleccionarRonda();
  lista.innerHTML = "";
  ronda.forEach(c=>{
    const li = document.createElement("li");
    li.textContent = c.texto;
    lista.appendChild(li);
  });

  vistaLectura.classList.remove("hidden");
  vistaRespuesta.classList.add("hidden");

  timerEl.classList.remove("hidden");
  btnTerminar.classList.remove("hidden");

  let t = 90;
  timerEl.textContent = t;

  timer = setInterval(()=>{
    t--;
    timerEl.textContent = t;
    if(t<=0) terminar();
  },1000);
};

btnTerminar.onclick = terminar;

function terminar(){
  clearInterval(timer);
  vistaRespuesta.classList.add("hidden");
  vistaLectura.classList.remove("hidden");
  btnTerminar.classList.add("hidden");
  if(musicaActiva) musica.play();
}
